# Work It Out - 产品需求文档 (PRD)

## 文档信息
| 项目 | 内容 |
|------|------|
| 产品名称 | Work It Out |
| 版本 | 1.0 |
| 创建日期 | 2025-12-25 |
| 文档状态 | 草案 |

---

## 1. 产品概述

### 1.1 产品愿景
**Work It Out** 是一款专为学术研究者设计的论文项目管理平台，旨在帮助学生和研究团队高效管理论文写作的全生命周期——从选题、文献调研、写作到最终提交。

### 1.2 目标用户
| 用户类型 | 描述 | 核心需求 |
|----------|------|----------|
| 本科/硕士/博士研究生 | 独立完成毕业论文 | 进度管理、文献整理、版本控制 |
| 研究团队 | 多人协作完成研究项目 | 实时协作、任务分配、评审反馈 |
| 导师/指导教师 | 指导学生论文写作 | 进度监控、批注评论、版本审阅 |

### 1.3 核心价值主张
- **一站式管理**：将论文写作所需的所有工具整合在一个平台
- **流程可视化**：清晰展示论文进度，避免拖延
- **协作无障碍**：支持多人实时编辑，导师反馈即时可见
- **学术专业化**：原生支持文献管理、引用格式、LaTeX导出

---

## 2. 功能需求

### 2.1 用户系统

#### 2.1.1 用户注册与登录
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 邮箱注册 | P0 | 使用邮箱+密码注册账号 |
| 邮箱登录 | P0 | 邮箱+密码登录 |
| 第三方登录 | P2 | 支持 Google/GitHub 登录 |
| 忘记密码 | P1 | 邮箱验证重置密码 |
| 个人资料 | P1 | 头像、昵称、所属机构 |

#### 2.1.2 用户角色
| 角色 | 权限 |
|------|------|
| 项目所有者 | 完全控制权，可删除项目、管理成员 |
| 协作者 | 可编辑文档、管理任务和文献 |
| 导师/审阅者 | 可查看、评论，不可直接编辑 |
| 访客 | 仅查看（需项目设置为公开） |

---

### 2.2 项目管理

#### 2.2.1 项目 CRUD
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 创建项目 | P0 | 输入标题、描述、目标日期 |
| 项目列表 | P0 | 展示所有项目，支持筛选排序 |
| 项目详情 | P0 | 项目概览、统计数据 |
| 编辑项目 | P0 | 修改项目信息 |
| 删除项目 | P1 | 软删除，可恢复 |
| 归档项目 | P1 | 完成的项目归档保存 |

#### 2.2.2 项目模板
| 模板类型 | 包含内容 |
|----------|----------|
| 本科毕业论文 | 预设章节结构、常见里程碑 |
| 硕士学位论文 | 更详细的章节、文献综述模板 |
| 期刊论文 | IMRaD 结构模板 |
| 自定义 | 空白项目 |

---

### 2.3 进度追踪

#### 2.3.1 任务管理
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 创建任务 | P0 | 标题、描述、截止日期、负责人 |
| 任务状态 | P0 | 待办/进行中/已完成 |
| 子任务 | P1 | 支持任务分解 |
| 任务标签 | P1 | 自定义标签分类 |
| 任务优先级 | P1 | 高/中/低 |
| 任务提醒 | P1 | 截止日期前提醒 |

#### 2.3.2 视图模式
| 视图 | 优先级 | 描述 |
|------|--------|------|
| 看板视图 | P0 | 拖拽式任务板，按状态分列 |
| 列表视图 | P0 | 传统列表，支持排序筛选 |
| 甘特图 | P1 | 时间线视图，展示任务依赖 |
| 日历视图 | P2 | 按日期展示任务 |

#### 2.3.3 里程碑
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 创建里程碑 | P0 | 关键节点，如"开题报告"、"初稿完成" |
| 里程碑追踪 | P0 | 展示完成状态和剩余时间 |
| 里程碑提醒 | P1 | 临近时发送通知 |

#### 2.3.4 进度统计
| 指标 | 描述 |
|------|------|
| 任务完成率 | 已完成/总任务数 |
| 字数进度 | 当前字数/目标字数 |
| 时间进度 | 已用时间/计划时间 |
| 燃尽图 | 剩余工作量趋势 |

---

### 2.4 文献管理

#### 2.4.1 文献录入
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 手动添加 | P0 | 表单输入文献信息 |
| BibTeX 导入 | P0 | 上传 .bib 文件批量导入 |
| DOI 导入 | P1 | 输入 DOI 自动获取元数据 |
| ISBN 导入 | P2 | 输入 ISBN 导入书籍信息 |
| PDF 解析 | P2 | 上传 PDF 自动提取元数据 |

#### 2.4.2 文献信息
| 字段 | 必填 | 描述 |
|------|------|------|
| 标题 | 是 | 文献标题 |
| 作者 | 是 | 作者列表 |
| 年份 | 是 | 发表年份 |
| 期刊/会议 | 否 | 发表来源 |
| DOI | 否 | 数字对象标识符 |
| URL | 否 | 在线链接 |
| 摘要 | 否 | 文献摘要 |
| PDF 文件 | 否 | 上传 PDF 附件 |

#### 2.4.3 文献组织
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 标签系统 | P0 | 自定义标签，支持多标签 |
| 文件夹分组 | P1 | 层级文件夹组织 |
| 阅读状态 | P0 | 未读/阅读中/已读 |
| 星标收藏 | P1 | 重要文献标记 |
| 评分 | P2 | 1-5 星评价 |

#### 2.4.4 阅读笔记
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 添加笔记 | P0 | 为文献添加阅读笔记 |
| 高亮标注 | P1 | PDF 内高亮和批注 |
| 笔记搜索 | P1 | 全文搜索笔记内容 |
| 笔记导出 | P2 | 导出为 Markdown |

#### 2.4.5 引用功能
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 引用格式生成 | P0 | 支持 APA、MLA、Chicago、GB/T 7714 等 |
| 一键复制 | P0 | 复制格式化引用文本 |
| BibTeX 导出 | P0 | 导出选中文献为 .bib |
| 参考文献列表 | P1 | 自动生成参考文献列表 |

---

### 2.5 文档写作

#### 2.5.1 文档结构
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 章节树 | P0 | 层级结构组织文档 |
| 拖拽排序 | P0 | 调整章节顺序 |
| 章节模板 | P1 | 预设章节内容模板 |
| 大纲视图 | P1 | 快速导航和结构预览 |

#### 2.5.2 富文本编辑器
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 基础格式 | P0 | 标题、粗体、斜体、列表 |
| 表格 | P0 | 插入和编辑表格 |
| 图片 | P0 | 插入图片，支持拖拽上传 |
| 代码块 | P1 | 语法高亮代码块 |
| 数学公式 | P1 | LaTeX 公式渲染 |
| 脚注 | P1 | 添加脚注 |
| 文献引用 | P0 | 插入文献引用标记 |

#### 2.5.3 写作辅助
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 字数统计 | P0 | 实时显示字数/词数 |
| 自动保存 | P0 | 定时自动保存 |
| 拼写检查 | P2 | 基础拼写错误提示 |
| 写作目标 | P1 | 设置每日/章节字数目标 |

---

### 2.6 版本控制

#### 2.6.1 版本管理
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 自动版本 | P0 | 定期自动创建版本快照 |
| 手动版本 | P0 | 用户主动保存版本，添加备注 |
| 版本列表 | P0 | 查看所有历史版本 |
| 版本预览 | P0 | 查看任意版本内容 |
| 版本回滚 | P0 | 恢复到指定版本 |

#### 2.6.2 版本对比
| 功能 | 优先级 | 描述 |
|------|--------|------|
| Diff 视图 | P0 | 并排对比两个版本差异 |
| 变更高亮 | P0 | 高亮显示增删改内容 |
| 统计信息 | P1 | 显示变更行数、字数差异 |

---

### 2.7 实时协作

#### 2.7.1 多人编辑
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 实时同步 | P1 | 多人同时编辑，实时同步 |
| 协作光标 | P1 | 显示其他用户的光标位置 |
| 在线状态 | P1 | 显示当前在线的协作者 |
| 冲突处理 | P1 | CRDT 算法自动合并 |

#### 2.7.2 评论系统
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 行内评论 | P1 | 选中文本添加评论 |
| 评论回复 | P1 | 支持评论讨论 |
| 评论解决 | P1 | 标记评论为已解决 |
| @提及 | P1 | 提及特定用户 |

#### 2.7.3 通知系统
| 功能 | 优先级 | 描述 |
|------|--------|------|
| 站内通知 | P1 | 应用内通知中心 |
| 邮件通知 | P2 | 重要事件邮件提醒 |
| 通知设置 | P1 | 自定义通知偏好 |

---

### 2.8 导出功能

#### 2.8.1 导出格式
| 格式 | 优先级 | 描述 |
|------|--------|------|
| PDF | P0 | 导出为 PDF 文档 |
| Word (.docx) | P0 | 导出为 Word 文档 |
| LaTeX | P1 | 导出为 LaTeX 源文件 |
| Markdown | P1 | 导出为 Markdown |
| HTML | P2 | 导出为网页 |

#### 2.8.2 导出选项
| 选项 | 描述 |
|------|------|
| 导出范围 | 全文/选中章节 |
| 包含目录 | 是否生成目录 |
| 包含参考文献 | 是否附加参考文献列表 |
| 引用格式 | 选择引用格式标准 |
| 模板样式 | 选择导出模板 |

---

## 3. 非功能需求

### 3.1 性能要求
| 指标 | 要求 |
|------|------|
| 页面加载时间 | < 2 秒 |
| API 响应时间 | < 500ms (P95) |
| 实时同步延迟 | < 200ms |
| 并发用户数 | 支持 1000+ 同时在线 |

### 3.2 安全要求
| 要求 | 描述 |
|------|------|
| 数据加密 | HTTPS 传输，数据库加密存储 |
| 身份认证 | JWT Token，支持刷新 |
| 权限控制 | 基于角色的访问控制 (RBAC) |
| 数据备份 | 每日自动备份 |

### 3.3 可用性要求
| 要求 | 描述 |
|------|------|
| 响应式设计 | 支持桌面和平板设备 |
| 浏览器兼容 | Chrome、Firefox、Safari、Edge 最新版 |
| 离线支持 | 基础离线编辑能力 (P2) |

---

## 4. 技术架构

### 4.1 技术栈
| 层级 | 技术选型 |
|------|----------|
| 前端框架 | Vue 3 + TypeScript |
| 构建工具 | Vite |
| 状态管理 | Pinia |
| UI 组件库 | Element Plus |
| 富文本编辑器 | Tiptap |
| 实时协作 | Yjs (CRDT) |
| 后端框架 | Python FastAPI |
| ORM | SQLAlchemy 2.0 |
| 数据库 | PostgreSQL |
| 缓存 | Redis |
| 文件存储 | MinIO / S3 |
| 文档转换 | Pandoc |

### 4.2 系统架构图
```
┌─────────────────────────────────────────────────────────────┐
│                        客户端 (Vue 3)                        │
├─────────────────────────────────────────────────────────────┤
│  Element Plus UI  │  Tiptap Editor  │  Yjs Collaboration    │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                     API Gateway (Nginx)                      │
└─────────────────────────────────────────────────────────────┘
                              │
              ┌───────────────┼───────────────┐
              ▼               ▼               ▼
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│   FastAPI       │ │   WebSocket     │ │   Celery        │
│   REST API      │ │   Server        │ │   Worker        │
└─────────────────┘ └─────────────────┘ └─────────────────┘
              │               │               │
              └───────────────┼───────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                      数据层                                  │
├─────────────────┬─────────────────┬─────────────────────────┤
│   PostgreSQL    │     Redis       │      MinIO/S3           │
│   (主数据库)     │    (缓存/队列)   │     (文件存储)           │
└─────────────────┴─────────────────┴─────────────────────────┘
```

---

## 5. 数据模型

### 5.1 核心实体关系
```
User ──┬── owns ──────> Project
       │
       └── member_of ──> Project (through ProjectMember)

Project ──┬── has_many ──> Task
          ├── has_many ──> Milestone
          ├── has_many ──> Literature
          └── has_many ──> Document

Document ──┬── has_many ──> DocumentVersion
           └── has_many ──> Comment

Literature ──┬── has_many ──> LiteratureNote
             └── has_many ──> Tag (through LiteratureTagRelation)
```

### 5.2 主要数据表
详见技术设计文档中的数据库 Schema。

---

## 6. 用户界面

### 6.1 主要页面
| 页面 | 描述 |
|------|------|
| 登录/注册 | 用户认证入口 |
| 仪表盘 | 项目概览、快捷入口、近期任务 |
| 项目详情 | 项目信息、成员、设置 |
| 任务看板 | 看板/甘特图/列表视图 |
| 文献库 | 文献列表、导入、详情 |
| 写作编辑器 | 大纲导航 + 富文本编辑 + 版本历史 |
| 设置 | 个人设置、通知偏好 |

### 6.2 设计原则
- **简洁专注**：减少干扰，专注写作
- **信息层级**：重要信息突出显示
- **操作便捷**：常用功能快捷访问
- **反馈及时**：操作结果即时反馈

---

## 7. 发布计划

### 7.1 MVP (v0.1)
**目标**：核心功能可用，单用户场景

包含功能：
- [x] 用户注册/登录
- [x] 项目 CRUD
- [x] 任务管理 + 看板视图
- [x] 里程碑管理
- [x] 基础文献管理
- [x] BibTeX 导入

### 7.2 v0.2 - 写作功能
- [ ] 文档编辑器 (Tiptap)
- [ ] 章节结构管理
- [ ] 版本历史
- [ ] 版本对比

### 7.3 v0.3 - 协作功能
- [ ] 项目成员管理
- [ ] 实时协作编辑
- [ ] 评论系统
- [ ] 通知系统

### 7.4 v1.0 - 完整版
- [ ] 甘特图视图
- [ ] DOI 导入
- [ ] PDF/Word/LaTeX 导出
- [ ] 引用格式生成
- [ ] 移动端适配

---

## 8. 成功指标

| 指标 | 目标 |
|------|------|
| 用户注册转化率 | > 30% |
| 日活跃用户 (DAU) | 持续增长 |
| 用户留存率 (7日) | > 40% |
| 项目完成率 | > 60% |
| 用户满意度 (NPS) | > 50 |

---

## 9. 风险与缓解

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 实时协作复杂度高 | 开发延期 | 先实现基础版本，迭代优化 |
| 文件格式兼容性 | 用户体验差 | 使用成熟的 Pandoc 方案 |
| 数据安全问题 | 用户信任度 | 加密存储、定期安全审计 |
| 性能瓶颈 | 用户流失 | 性能监控、及时优化 |

---

## 附录

### A. 术语表
| 术语 | 定义 |
|------|------|
| CRDT | Conflict-free Replicated Data Type，无冲突复制数据类型 |
| BibTeX | 一种用于格式化参考文献的文件格式 |
| DOI | Digital Object Identifier，数字对象标识符 |
| LaTeX | 一种排版系统，常用于学术论文 |

### B. 参考资料
- [Tiptap Editor](https://tiptap.dev/)
- [Yjs CRDT](https://yjs.dev/)
- [FastAPI](https://fastapi.tiangolo.com/)
- [Element Plus](https://element-plus.org/)
